<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>British Hills: Classroom Snooker</title>
    <!-- Matter.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.19.0/matter.min.js"></script>
    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Lato:wght@400;900&display=swap" rel="stylesheet">
    
    <style>
        body { 
            margin: 0; 
            overflow: hidden; 
            background-color: #1a1a1a; 
            font-family: 'Lato', sans-serif;
            touch-action: none;
        }
        
        .serif-font { font-family: 'Playfair Display', serif; }
        
        /* Snooker Table Felt */
        #game-container {
            background-color: #0d5c3e; /* Snooker Green */
            background-image: 
                radial-gradient(circle at 30% 30%, rgba(255,255,255,0.05) 0%, rgba(0,0,0,0.2) 100%),
                url("data:image/svg+xml,%3Csvg width='200' height='200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.08'/%3E%3C/svg%3E");
            box-shadow: inset 0 0 80px rgba(0,0,0,0.8);
        }

        /* Wood Frame */
        #table-frame {
            position: absolute;
            inset: 0; /* Full Screen */
            border: 25px solid #3e2723; /* Fixed 25px Border */
            pointer-events: none;
            z-index: 20;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.8);
        }

        .interactive { pointer-events: auto; }
        
        /* UI Panel */
        .glass-panel {
            background: rgba(20, 20, 20, 0.8);
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255,255,255,0.15);
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            cursor: pointer;
            transition: all 0.2s;
        }
        .glass-panel:hover {
            background: rgba(40, 40, 40, 0.9);
            transform: translateY(-2px);
        }
        
        .active-team {
            background: rgba(255, 215, 0, 0.15);
            border-color: rgba(255, 215, 0, 0.6);
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.2);
        }

        /* Pockets (Visual) */
        .pocket-visual {
            position: absolute;
            background: #000;
            border-radius: 50%;
            z-index: 10; 
            box-shadow: inset 0 0 10px #000;
            border: 2px solid #2a1810;
        }

        /* Aim Arrow */
        #aim-line {
            position: absolute;
            height: 3px;
            background: linear-gradient(90deg, rgba(255,255,255,0.2) 0%, rgba(255,255,255,1) 100%);
            transform-origin: left center;
            display: none;
            pointer-events: none;
            z-index: 50;
            box-shadow: 0 0 8px white;
            border-radius: 2px;
        }
        #aim-line::after {
            content: '';
            position: absolute;
            right: -6px; top: -5px;
            border-top: 6px solid transparent;
            border-bottom: 6px solid transparent;
            border-left: 10px solid white;
        }

        /* Active Marker Ring */
        #cue-marker {
            position: absolute;
            width: 40px; height: 40px;
            border: 2px dashed rgba(255,255,255,0.5);
            border-radius: 50%;
            pointer-events: none;
            z-index: 4;
            display: none;
            animation: spin 4s linear infinite;
        }
        @keyframes spin { 100% { transform: rotate(360deg); } }

        /* Notification */
        #notification {
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.3s;
        }
        .show-notif { opacity: 1 !important; transform: translateY(0) !important; }

        /* Scoreboard Toggle */
        .hidden-scores {
            opacity: 0;
            pointer-events: none;
            transform: translateY(-20px);
        }
        #scoreboard-container { transition: all 0.3s; }

    </style>
</head>
<body>

    <!-- Game Container (Full Screen) -->
    <div id="game-container" class="absolute inset-0 z-0"></div>
    
    <!-- Visual Frame (Full Screen Overlay) -->
    <div id="table-frame"></div>
    
    <div id="aim-line"></div>
    <div id="cue-marker"></div>

    <!-- UI LAYER -->
    <div id="ui-layer" class="absolute inset-0 pointer-events-none z-30 flex flex-col justify-between p-2 md:p-6">
        
        <!-- Top Bar -->
        <div class="flex flex-col w-full max-w-5xl mx-auto gap-2">
            <!-- Controls Row -->
            <div class="flex justify-end pointer-events-auto">
                <button onclick="toggleScores()" class="p-2 bg-gray-800 bg-opacity-80 rounded-full text-gray-300 hover:text-white border border-gray-600 transition shadow-md" title="Toggle Scores">
                    <!-- Eye Icon -->
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                    </svg>
                </button>
            </div>

            <!-- Scoreboard Header -->
            <div id="scoreboard-container" class="flex justify-between items-start gap-2 w-full transition-all duration-300">
                <!-- Team 1 -->
                <div id="card-0" class="glass-panel interactive flex-1 rounded-lg p-2 text-center" onclick="setTurn(0)">
                    <div class="text-[10px] md:text-xs text-gray-400 font-bold tracking-widest uppercase mb-1 t-name-0">TEAM 1</div>
                    <div class="text-2xl md:text-4xl font-black text-white t-score-0">0</div>
                </div>
                <!-- Team 2 -->
                <div id="card-1" class="glass-panel interactive flex-1 rounded-lg p-2 text-center" onclick="setTurn(1)">
                    <div class="text-[10px] md:text-xs text-gray-400 font-bold tracking-widest uppercase mb-1 t-name-1">TEAM 2</div>
                    <div class="text-2xl md:text-4xl font-black text-white t-score-1">0</div>
                </div>
                <!-- Team 3 -->
                <div id="card-2" class="glass-panel interactive flex-1 rounded-lg p-2 text-center" onclick="setTurn(2)">
                    <div class="text-[10px] md:text-xs text-gray-400 font-bold tracking-widest uppercase mb-1 t-name-2">TEAM 3</div>
                    <div class="text-2xl md:text-4xl font-black text-white t-score-2">0</div>
                </div>
                <!-- Team 4 -->
                <div id="card-3" class="glass-panel interactive flex-1 rounded-lg p-2 text-center" onclick="setTurn(3)">
                    <div class="text-[10px] md:text-xs text-gray-400 font-bold tracking-widest uppercase mb-1 t-name-3">TEAM 4</div>
                    <div class="text-2xl md:text-4xl font-black text-white t-score-3">0</div>
                </div>
            </div>
        </div>

        <!-- Notification Area -->
        <div id="notification" class="self-center bg-black bg-opacity-70 px-8 py-3 rounded-full text-white font-bold text-xl backdrop-blur-md border border-gray-600">
            Foul! Cue Ball Potted (-4)
        </div>

        <!-- Bottom Controls -->
        <div class="flex justify-between items-end w-full">
            <div class="interactive">
                <button onclick="toggleSetup()" class="p-3 bg-gray-800 rounded-full hover:bg-gray-700 text-white shadow-lg border border-gray-600 transition">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /></svg>
                </button>
            </div>

            <div class="interactive">
                <button onclick="reRack()" class="bg-amber-700 hover:bg-amber-600 text-white px-6 py-3 rounded-lg font-bold shadow-lg border-b-4 border-amber-900 transition flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z" clip-rule="evenodd" /></svg>
                    RE-RACK TABLE
                </button>
            </div>
        </div>
    </div>

    <!-- SETUP MENU -->
    <div id="setup-modal" class="absolute inset-0 z-50 bg-black bg-opacity-90 flex items-center justify-center" style="display: none;">
        <div class="bg-gray-900 border border-gray-700 p-8 rounded-xl w-full max-w-2xl shadow-2xl relative">
            <button onclick="toggleSetup()" class="absolute top-4 right-4 text-gray-500 hover:text-white">âœ•</button>
            <h1 class="serif-font text-4xl text-white mb-6 text-center text-amber-500">Match Setup</h1>
            
            <div class="grid grid-cols-2 gap-4 mb-8">
                <input type="text" id="name-0" class="bg-gray-800 text-white p-3 rounded border border-gray-600" placeholder="Team 1 Name">
                <input type="text" id="name-1" class="bg-gray-800 text-white p-3 rounded border border-gray-600" placeholder="Team 2 Name">
                <input type="text" id="name-2" class="bg-gray-800 text-white p-3 rounded border border-gray-600" placeholder="Team 3 Name">
                <input type="text" id="name-3" class="bg-gray-800 text-white p-3 rounded border border-gray-600" placeholder="Team 4 Name">
            </div>

            <div class="flex justify-between border-t border-gray-700 pt-6">
                <button onclick="resetMatch()" class="text-red-500 hover:text-red-400 font-bold px-4 py-2 border border-red-900 rounded hover:bg-red-900 transition">RESET MATCH SCORES</button>
                <button onclick="saveNames()" class="bg-green-700 hover:bg-green-600 text-white px-8 py-3 rounded font-bold shadow-lg">SAVE & PLAY</button>
            </div>
        </div>
    </div>

    <script>
        // --- CONFIG ---
        const TEAMS = [
            { name: "Red Dragons", score: 0 },
            { name: "Blue Sharks", score: 0 },
            { name: "Green Snakes", score: 0 },
            { name: "Yellow Eagles", score: 0 }
        ];
        
        let activeTeamId = 0;
        
        // --- PHYSICS VARS ---
        const Engine = Matter.Engine,
              Render = Matter.Render,
              Runner = Matter.Runner,
              Bodies = Matter.Bodies,
              Composite = Matter.Composite,
              Events = Matter.Events,
              Body = Matter.Body,
              Vector = Matter.Vector;

        let engine, render, runner;
        let cueBall;
        let width, height;
        const BORDER_SIZE = 25; // Frame thickness

        // --- INIT ---
        window.onload = function() {
            initGame();
            updateUI();
        };

        function initGame() {
            // FIX: Ensure clean state if re-init
            if(render) {
                Render.stop(render);
                Runner.stop(runner);
            }

            const container = document.getElementById('game-container');
            // Use getBoundingClientRect for sub-pixel precision
            const rect = container.getBoundingClientRect();
            width = rect.width;
            height = rect.height;

            // Engine
            engine = Engine.create();
            engine.world.gravity.y = 0; 
            engine.world.gravity.x = 0;

            // Clean previous
            container.innerHTML = '';
            
            // Add Visual Pockets (HTML)
            createVisualPockets(container, width, height);

            // Render Physics
            render = Render.create({
                element: container,
                engine: engine,
                options: {
                    width: width,
                    height: height,
                    wireframes: false,
                    background: 'transparent',
                    pixelRatio: window.devicePixelRatio
                }
            });

            // Table Boundaries (Physically aligned with visual border)
            const wallThick = 100; // Thick enough to not tunnel
            const wallOpt = { isStatic: true, render: { fillStyle: 'transparent' }, restitution: 0.6 };
            const CUSHION = 10; // Increased cushion inset to handle Right/Bottom issues
            
            // Coordinates based on BORDER_SIZE + CUSHION
            // NOTE: Matter.js bodies are positioned by CENTER point
            
            // Top Wall: Bottom face at Y = BORDER_SIZE + CUSHION
            const topY = (BORDER_SIZE + CUSHION) - (wallThick/2);
            
            // Bottom Wall: Top face at Y = height - (BORDER_SIZE + CUSHION)
            // Fix: Added extra safety margin for bottom/right which often have browser UI issues
            const SAFETY = 10; 
            const botY = (height - (BORDER_SIZE + CUSHION + SAFETY)) + (wallThick/2);
            
            // Left Wall: Right face at X = BORDER_SIZE + CUSHION
            const leftX = (BORDER_SIZE + CUSHION) - (wallThick/2);
            
            // Right Wall: Left face at X = width - (BORDER_SIZE + CUSHION)
            const rightX = (width - (BORDER_SIZE + CUSHION + SAFETY)) + (wallThick/2);

            const cushions = [
                Bodies.rectangle(width/2, topY, width, wallThick, wallOpt), 
                Bodies.rectangle(width/2, botY, width, wallThick, wallOpt), 
                Bodies.rectangle(leftX, height/2, wallThick, height, wallOpt), 
                Bodies.rectangle(rightX, height/2, wallThick, height, wallOpt)
            ];
            Composite.add(engine.world, cushions);

            // Physics Pockets (Sensors)
            createPhysicsPockets();

            // Collision Handling
            Events.on(engine, 'collisionStart', handleCollisions);

            // Input Handling
            document.body.addEventListener('pointerdown', handleInputStart);
            document.body.addEventListener('pointermove', handleInputMove);
            document.body.addEventListener('pointerup', handleInputEnd);

            // Start
            Render.run(render);
            runner = Runner.create();
            Runner.run(runner, engine);

            reRack(); 
        }

        // --- POCKETS ---
        function createVisualPockets(container, w, h) {
            const size = 60; // Increased visual size from 50
            const cornerOffset = BORDER_SIZE * 0.8;
            const midX = w / 2;
            const midY = BORDER_SIZE * 0.5; // Tucked into rail

            const positions = [
                { x: cornerOffset, y: cornerOffset },           // TL
                { x: midX, y: midY },                           // TM
                { x: w - cornerOffset, y: cornerOffset },       // TR
                { x: cornerOffset, y: h - cornerOffset },       // BL
                { x: midX, y: h - midY },                       // BM
                { x: w - cornerOffset, y: h - cornerOffset }    // BR
            ];

            positions.forEach(pos => {
                const el = document.createElement('div');
                el.className = 'pocket-visual';
                el.style.width = size + 'px';
                el.style.height = size + 'px';
                el.style.left = (pos.x - size/2) + 'px'; // Center div
                el.style.top = (pos.y - size/2) + 'px';
                container.appendChild(el);
            });
        }

        function createPhysicsPockets() {
            const r = 25; // Sensor radius
            const opt = { isStatic: true, isSensor: true, label: 'POCKET', render: { fillStyle: 'transparent' } }; 
            
            // Align physics pockets with visual pockets
            const cornerOffset = BORDER_SIZE * 0.8;
            const midX = width / 2;
            const midY = BORDER_SIZE * 0.5;

            const pockets = [
                Bodies.circle(cornerOffset, cornerOffset, r, opt), // TL
                Bodies.circle(midX, midY, r, opt), // TM
                Bodies.circle(width - cornerOffset, cornerOffset, r, opt), // TR
                Bodies.circle(cornerOffset, height - cornerOffset, r, opt), // BL
                Bodies.circle(midX, height - midY, r, opt), // BM
                Bodies.circle(width - cornerOffset, height - cornerOffset, r, opt) // BR
            ];
            Composite.add(engine.world, pockets);
        }

        function reRack() {
            const bodies = Composite.allBodies(engine.world);
            const balls = bodies.filter(b => b.label === 'BALL' || b.label === 'CUE');
            Composite.remove(engine.world, balls);

            const ballRadius = 12;
            const ballOpt = (color, value) => ({
                label: 'BALL',
                plugin: { value: value },
                restitution: 0.9,
                friction: 0.005,
                frictionAir: 0.02,
                density: 0.05,
                render: { fillStyle: color, strokeStyle: '#000', lineWidth: 1 }
            });

            // 1. Cue Ball - D Zone area
            cueBall = Bodies.circle(width * 0.2, height / 2 + 30, ballRadius, {
                ...ballOpt('#fff', 0),
                label: 'CUE'
            });
            Composite.add(engine.world, cueBall);

            // 2. Reds
            const startX = width * 0.7;
            const startY = height / 2;
            const spacing = ballRadius * 2 + 1;
            let rows = 5;
            
            for (let r = 0; r < rows; r++) {
                for (let c = 0; c <= r; c++) {
                    const x = startX + (r * spacing * 0.866);
                    const y = startY - (r * spacing * 0.5) + (c * spacing);
                    Composite.add(engine.world, Bodies.circle(x, y, ballRadius, ballOpt('#d00', 1)));
                }
            }

            // 3. Colors
            const colors = [
                { c: '#fb0', v: 2, x: width * 0.2, y: height/2 - 60 },
                { c: '#080', v: 3, x: width * 0.2, y: height/2 + 60 },
                { c: '#963', v: 4, x: width * 0.2, y: height/2 },
                { c: '#00f', v: 5, x: width * 0.5, y: height/2 },
                { c: '#f69', v: 6, x: width * 0.65, y: height/2 },
                { c: '#000', v: 7, x: width * 0.9, y: height/2 }
            ];

            colors.forEach(col => {
                Composite.add(engine.world, Bodies.circle(col.x, col.y, ballRadius, ballOpt(col.c, col.v)));
            });

            updateCueMarker();
        }

        // --- INPUT ---
        let dragStart = null;

        function handleInputStart(e) {
            if(e.target.tagName === 'BUTTON' || e.target.closest('.interactive')) return;
            if(!cueBall || Body.getSpeed(cueBall) > 0.5) return;
            dragStart = { x: e.clientX, y: e.clientY };
        }

        function handleInputMove(e) {
            if(!dragStart || !cueBall) return;

            const current = { x: e.clientX, y: e.clientY };
            const dx = dragStart.x - current.x; 
            const dy = dragStart.y - current.y;
            const len = Math.sqrt(dx*dx + dy*dy);

            if(len > 10) {
                const angle = Math.atan2(dy, dx);
                const line = document.getElementById('aim-line');
                const power = Math.min(len, 200) * 1.5; 

                line.style.display = 'block';
                line.style.width = power + 'px';
                line.style.left = cueBall.position.x + 'px';
                line.style.top = cueBall.position.y + 'px';
                line.style.transform = `rotate(${angle}rad)`;
            }
        }

        function handleInputEnd(e) {
            if(!dragStart || !cueBall) return;

            const current = { x: e.clientX, y: e.clientY };
            const dx = dragStart.x - current.x; 
            const dy = dragStart.y - current.y;
            const len = Math.sqrt(dx*dx + dy*dy);

            if(len > 20) {
                const force = 0.00025 * Math.min(len, 400);
                Body.applyForce(cueBall, cueBall.position, { x: dx * force, y: dy * force });
                document.getElementById('cue-marker').style.display = 'none';
            }

            dragStart = null;
            document.getElementById('aim-line').style.display = 'none';
        }

        // --- LOGIC ---
        function handleCollisions(event) {
            event.pairs.forEach(pair => {
                const a = pair.bodyA;
                const b = pair.bodyB;

                let ball = null;
                if(a.label === 'POCKET' && (b.label === 'BALL' || b.label === 'CUE')) ball = b;
                else if(b.label === 'POCKET' && (a.label === 'BALL' || a.label === 'CUE')) ball = a;

                if(ball) {
                    if(ball.label === 'CUE') {
                        showNotification(`FOUL! Cue Ball Potted (-4 to ${TEAMS[activeTeamId].name})`);
                        TEAMS[activeTeamId].score = Math.max(0, TEAMS[activeTeamId].score - 4);
                        updateUI();
                        
                        Body.setPosition(ball, { x: width * 0.2, y: height/2 });
                        Body.setVelocity(ball, { x: 0, y: 0 });
                    } else {
                        const pts = ball.plugin.value;
                        TEAMS[activeTeamId].score += pts;
                        updateUI();
                        showNotification(`${TEAMS[activeTeamId].name} potted a ball! (+${pts})`);
                        Composite.remove(engine.world, ball);
                    }
                }
            });
        }

        function updateCueMarker() {
            requestAnimationFrame(trackCue);
        }

        function trackCue() {
            if(cueBall && Body.getSpeed(cueBall) < 0.2) {
                const marker = document.getElementById('cue-marker');
                marker.style.display = 'block';
                // Marker is 40px, cueball 12px rad. Center aligned.
                // Marker Left = Ball X - MarkerRadius (20)
                marker.style.left = (cueBall.position.x - 20) + 'px'; 
                marker.style.top = (cueBall.position.y - 20) + 'px';
            } else {
                document.getElementById('cue-marker').style.display = 'none';
            }
            requestAnimationFrame(trackCue);
        }

        // --- UI ---
        function toggleScores() {
            const sb = document.getElementById('scoreboard-container');
            sb.classList.toggle('hidden-scores');
        }

        function setTurn(id) {
            activeTeamId = id;
            updateUI();
            showNotification(`${TEAMS[id].name}'s Turn`);
        }

        function updateUI() {
            TEAMS.forEach((t, i) => {
                document.querySelector(`.t-name-${i}`).innerText = t.name;
                document.querySelector(`.t-score-${i}`).innerText = t.score;
                
                const card = document.getElementById(`card-${i}`);
                if(i === activeTeamId) card.classList.add('active-team');
                else card.classList.remove('active-team');
            });
        }

        function showNotification(msg) {
            const el = document.getElementById('notification');
            el.innerText = msg;
            el.classList.add('show-notif');
            setTimeout(() => el.classList.remove('show-notif'), 2000);
        }

        function toggleSetup() {
            const el = document.getElementById('setup-modal');
            el.style.display = el.style.display === 'none' ? 'flex' : 'none';
            if(el.style.display === 'flex') {
                document.getElementById('name-0').value = TEAMS[0].name;
                document.getElementById('name-1').value = TEAMS[1].name;
                document.getElementById('name-2').value = TEAMS[2].name;
                document.getElementById('name-3').value = TEAMS[3].name;
            }
        }

        function saveNames() {
            TEAMS[0].name = document.getElementById('name-0').value || "Team 1";
            TEAMS[1].name = document.getElementById('name-1').value || "Team 2";
            TEAMS[2].name = document.getElementById('name-2').value || "Team 3";
            TEAMS[3].name = document.getElementById('name-3').value || "Team 4";
            updateUI();
            toggleSetup();
        }

        function resetMatch() {
            TEAMS.forEach(t => t.score = 0);
            updateUI();
            reRack();
            toggleSetup();
        }

        // Fix resize to reload physics world bounds
        window.addEventListener('resize', () => {
            // Debounce slightly or just run
            setTimeout(initGame, 200); 
        });

    </script>
</body>
</html>